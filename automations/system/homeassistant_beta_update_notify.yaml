---
# This alers me on via HTML5 
# of a new release of Home Assistant.
#
alias: System - Home Assistant Beta Update Notification
initial_state: on
trigger:
  - platform: homeassistant
    event: start
  - platform: state
    entity_id: binary_sensor.updater
    to: 'on'
condition:
  condition: and
  conditions:
    - condition: template
      value_template: "{{ not is_state('sensor.home_assistant_available_beta_version', 'unknown') }}"
    - condition: template
      value_template: "{{ not is_state('sensor.home_assistant_available_stable_version', 'unknown') }}"
    - condition: template
      value_template: "{{ not is_state('sensor.home_assistant_current_version', 'unknown') }}"
    - condition: template
      value_template: "{{ states('sensor.home_assistant_available_beta_version') > states('sensor.home_assistant_current_version') }}"
    - condition: template
      value_template: "{{ states('sensor.home_assistant_available_beta_version') > states('sensor.home_assistant_available_stable_version') }}"

action:
  - service: notify.html5_andrea
    data_template:
      title: "Updates Notification"
      message: "Home Assistant Version {{ states('sensor.home_assistant_available_stable_version') }} (BETA) update is now available"
