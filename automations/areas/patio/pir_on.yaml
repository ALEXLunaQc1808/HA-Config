---
id: '7563605597231'
alias: Patio - PIR
initial_state: on
trigger:
  - platform: state
    entity_id: group.patio_pir
    to: 'on'
condition:
  condition: and
  conditions:
    - condition: state
      entity_id: group.lights_automations_motion_house
      state: 'on'
    - condition: state
      entity_id: input_boolean.lights_automations_motion_patio
      state: 'on'
    - condition: or
      conditions:
        - condition: state
          entity_id: input_boolean.night_mode
          state: 'on'
        - condition: template
          value_template: >-
            {% if is_state("input_boolean.lights_automations_lux_patio", "on") %}
              {% if (states("sensor.patio_gzcgq01lm_illuminance_lux") | int) <= (states("input_number.lights_automations_lux_patio") | int) %}
                true
              {% else %}
                false
              {% endif %}
            {% else %}
              true
            {% endif %}
        - condition: state
          entity_id: sensor.patio_gzcgq01lm_illuminance_lux
          state: 'unavailable'
    - condition: state
      entity_id: light.patio_light
      state: 'off'
    - condition: or
      conditions:
        - condition: state
          entity_id: alarm_control_panel.home_alarm
          state: 'disarmed'
        - condition: state
          entity_id: alarm_control_panel.home_alarm
          state: 'armed_home'
        - condition: state
          entity_id: input_boolean.guest_mode
          state: 'on'
action:
  - service: light.turn_on
    data:
      entity_id: light.patio_lights
#      brightness_pct: 5
#      rgb_color: [255,255,255]
#      transition: 5
