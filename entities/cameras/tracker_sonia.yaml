---
platform: generic
name: Tracker Sonia
still_image_url: >-
  {%- set pitch = state_attr('sensor.view_sonia_espejo_brea', 'pitch') -%}
  {%- set c_longitude = state_attr('sensor.view_sonia_espejo_brea', 'c_longitude') -%}
  {%- set c_latitude = state_attr('sensor.view_sonia_espejo_brea', 'c_latitude') -%}
  {%- set o_longitude = state_attr('sensor.view_sonia_espejo_brea', 'o_longitude') -%}
  {%- set o_latitude = state_attr('sensor.view_sonia_espejo_brea', 'o_latitude') -%}
  {%- set m_longitude = state_attr('sensor.view_sonia_espejo_brea', 'm_longitude') -%}
  {%- set m_latitude = state_attr('sensor.view_sonia_espejo_brea', 'm_latitude') -%}
  {%- set pitch = state_attr('sensor.view_sonia_espejo_brea', 'pitch') -%}
  {%- set zoom = state_attr('sensor.view_sonia_espejo_brea', 'zoom') -%}
  {%- set bearing = state_attr('sensor.view_sonia_espejo_brea', 'bearing') -%}
  {%- set key = states('sensor.mapbox_key') -%}
  {%- if zoom == 'auto' -%}
    https://api.mapbox.com/styles/v1/mapbox/outdoors-v10/static/pin-s-l+2ecc71({{o_longitude}},{{o_latitude}}),pin-s-o+3498db({{c_longitude}},{{c_latitude}})/auto/400x400?access_token={{key}}
  {%- else -%}
    https://api.mapbox.com/styles/v1/mapbox/outdoors-v10/static/pin-s-l+2ecc71({{o_longitude}},{{o_latitude}}),pin-s-o+3498db({{c_longitude}},{{c_latitude}})/{{m_longitude}},{{m_latitude}},{{zoom}},{{bearing}},{{pitch}}/400x400?access_token={{key}}
  {%- endif -%}
limit_refetch_to_url_change: true
